{"version":3,"file":"quick_options_manager.min.js","sources":["../src/quick_options_manager.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Quick Start Options Manager - Visual interface for managing options\n *\n * @module     local_dttutor/quick_options_manager\n * @copyright  2025 Industria Elearning\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/str'], function($, Str) {\n    'use strict';\n\n    class QuickOptionsManager {\n        constructor(fieldname, options) {\n            this.fieldname = fieldname;\n            this.options = options || [];\n            this.container = null;\n            this.hiddenField = null;\n            this.tbody = null;\n\n            this.init();\n        }\n\n        init() {\n            // Find elements.\n            this.container = $('[data-fieldname=\"' + this.fieldname + '\"]');\n            if (!this.container.length) {\n                return;\n            }\n\n            this.hiddenField = this.container.find('input[type=\"hidden\"]');\n            this.tbody = this.container.find('[data-region=\"options-tbody\"]');\n\n            // Render current options.\n            this.renderOptions();\n\n            // Register event listeners.\n            this.registerEvents();\n        }\n\n        registerEvents() {\n            // Add button.\n            this.container.on('click', '[data-action=\"add-option\"]', () => {\n                this.addOption();\n            });\n\n            // Delete button (delegated).\n            this.container.on('click', '[data-action=\"delete-option\"]', (e) => {\n                const index = $(e.currentTarget).data('index');\n                this.deleteOption(index);\n            });\n\n            // Move up button.\n            this.container.on('click', '[data-action=\"move-up\"]', (e) => {\n                const index = $(e.currentTarget).data('index');\n                this.moveOption(index, -1);\n            });\n\n            // Move down button.\n            this.container.on('click', '[data-action=\"move-down\"]', (e) => {\n                const index = $(e.currentTarget).data('index');\n                this.moveOption(index, 1);\n            });\n\n            // Enter key in new fields.\n            this.container.find('[data-field]').on('keypress', (e) => {\n                if (e.key === 'Enter') {\n                    e.preventDefault();\n                    this.addOption();\n                }\n            });\n        }\n\n        renderOptions() {\n            this.tbody.empty();\n\n            if (this.options.length === 0) {\n                const emptyText = 'No options configured. Add your first option below.';\n                const emptyRow = $('<tr><td colspan=\"4\" class=\"text-center text-muted\">' + emptyText + '</td></tr>');\n                this.tbody.append(emptyRow);\n                return;\n            }\n\n            this.options.forEach((option, index) => {\n                const row = this.createOptionRow(option, index);\n                this.tbody.append(row);\n            });\n        }\n\n        createOptionRow(option, index) {\n            const row = $('<tr></tr>');\n\n            // Icon cell.\n            const iconCell = $('<td></td>').addClass('text-center').text(option.icon || '');\n\n            // Label cell.\n            const labelCell = $('<td></td>').text(option.label || '');\n\n            // Prompt cell.\n            const promptCell = $('<td></td>').text(option.prompt || '');\n\n            // Actions cell.\n            const actionsCell = $('<td></td>').addClass('text-center');\n\n            const btnGroup = $('<div></div>').addClass('btn-group btn-group-sm');\n\n            // Move up button.\n            if (index > 0) {\n                const upBtn = $('<button></button>')\n                    .attr('type', 'button')\n                    .addClass('btn btn-secondary')\n                    .attr('data-action', 'move-up')\n                    .attr('data-index', index)\n                    .attr('title', 'Move up')\n                    .html('<i class=\"icon fa fa-arrow-up fa-fw\"></i>');\n                btnGroup.append(upBtn);\n            }\n\n            // Move down button.\n            if (index < this.options.length - 1) {\n                const downBtn = $('<button></button>')\n                    .attr('type', 'button')\n                    .addClass('btn btn-secondary')\n                    .attr('data-action', 'move-down')\n                    .attr('data-index', index)\n                    .attr('title', 'Move down')\n                    .html('<i class=\"icon fa fa-arrow-down fa-fw\"></i>');\n                btnGroup.append(downBtn);\n            }\n\n            // Delete button.\n            const deleteBtn = $('<button></button>')\n                .attr('type', 'button')\n                .addClass('btn btn-danger')\n                .attr('data-action', 'delete-option')\n                .attr('data-index', index)\n                .attr('title', 'Delete')\n                .html('<i class=\"icon fa fa-trash fa-fw\"></i>');\n            btnGroup.append(deleteBtn);\n\n            actionsCell.append(btnGroup);\n\n            row.append(iconCell, labelCell, promptCell, actionsCell);\n\n            return row;\n        }\n\n        addOption() {\n            const iconField = this.container.find('[data-field=\"new-icon\"]');\n            const labelField = this.container.find('[data-field=\"new-label\"]');\n            const promptField = this.container.find('[data-field=\"new-prompt\"]');\n\n            const icon = iconField.val().trim();\n            const label = labelField.val().trim();\n            const prompt = promptField.val().trim();\n\n            // Validate.\n            if (!icon || !label || !prompt) {\n                Str.get_string('quickoption_validation_error', 'local_dttutor').done(function(message) {\n                    alert(message);\n                });\n                return;\n            }\n\n            // Add to array.\n            this.options.push({\n                icon: icon,\n                label: label,\n                prompt: prompt\n            });\n\n            // Clear fields.\n            iconField.val('');\n            labelField.val('');\n            promptField.val('');\n\n            // Re-render and update hidden field.\n            this.renderOptions();\n            this.updateHiddenField();\n        }\n\n        deleteOption(index) {\n            Str.get_string('quickoption_delete_confirm', 'local_dttutor').done((message) => {\n                if (confirm(message)) {\n                    this.options.splice(index, 1);\n                    this.renderOptions();\n                    this.updateHiddenField();\n                }\n            });\n        }\n\n        moveOption(index, direction) {\n            const newIndex = index + direction;\n\n            if (newIndex < 0 || newIndex >= this.options.length) {\n                return;\n            }\n\n            // Swap.\n            const temp = this.options[index];\n            this.options[index] = this.options[newIndex];\n            this.options[newIndex] = temp;\n\n            this.renderOptions();\n            this.updateHiddenField();\n        }\n\n        updateHiddenField() {\n            const json = JSON.stringify(this.options, null, 2);\n            this.hiddenField.val(json);\n        }\n    }\n\n    return {\n        init: function(fieldname, options) {\n            return new QuickOptionsManager(fieldname, options);\n        }\n    };\n});\n"],"names":["define","$","Str","QuickOptionsManager","constructor","fieldname","options","container","hiddenField","tbody","init","this","length","find","renderOptions","registerEvents","on","addOption","e","index","currentTarget","data","deleteOption","moveOption","key","preventDefault","empty","forEach","option","row","createOptionRow","append","emptyRow","iconCell","addClass","text","icon","labelCell","label","promptCell","prompt","actionsCell","btnGroup","upBtn","attr","html","downBtn","deleteBtn","iconField","labelField","promptField","val","trim","push","updateHiddenField","get_string","done","message","alert","confirm","splice","direction","newIndex","temp","json","JSON","stringify"],"mappings":"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"}