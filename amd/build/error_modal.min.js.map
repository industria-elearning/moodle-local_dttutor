{"version":3,"file":"error_modal.min.js","sources":["../src/error_modal.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Error modal for Tutor-IA\n *\n * @module     local_dttutor/error_modal\n * @copyright  2025 Datacurso\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/modal_factory', 'core/modal_events', 'core/str', 'core/templates'],\n    function($, ModalFactory, ModalEvents, Str, Templates) {\n    'use strict';\n\n    /**\n     * Show error modal with friendly message\n     *\n     * @param {string} message Error message to display\n     * @param {boolean} isConfigError Whether this is a configuration error\n     * @param {string} configUrl Optional configuration URL for admins\n     * @returns {Promise} Promise that resolves when modal is created\n     */\n    var showError = function(message, isConfigError, configUrl) {\n        var modalTitle = '';\n\n        return Str.get_strings([\n            {key: 'error_webservice_not_configured_short', component: 'local_dttutor'},\n            {key: 'pluginname', component: 'local_dttutor'},\n            {key: 'configure_now', component: 'local_dttutor'}\n        ]).then(function(strings) {\n            modalTitle = isConfigError ? strings[0] : strings[1];\n            var configureNowStr = strings[2];\n\n            // Prepare template context.\n            var context = {\n                message: message,\n                has_config_url: !!configUrl,\n                config_url: configUrl || '',\n                str_configure_now: configureNowStr\n            };\n\n            // Render template.\n            return Templates.render('local_dttutor/error_modal_body', context);\n        }).then(function(html) {\n            return ModalFactory.create({\n                type: ModalFactory.types.DEFAULT,\n                title: modalTitle,\n                body: html\n            });\n        }).then(function(modal) {\n            modal.show();\n\n            // Auto-hide after 10 seconds if not a config error.\n            if (!isConfigError) {\n                setTimeout(function() {\n                    modal.hide();\n                }, 10000);\n            }\n\n            return modal;\n        }).catch(function(error) {\n            // Fallback to alert if modal/template fails.\n            window.alert(message);\n            throw error;\n        });\n    };\n\n    /**\n     * Show configuration error modal\n     *\n     * @param {string} message Error message\n     * @param {string} configUrl Optional configuration URL\n     * @returns {Promise} Promise that resolves when modal is created\n     */\n    var showConfigError = function(message, configUrl) {\n        return showError(message, true, configUrl);\n    };\n\n    /**\n     * Show general error modal\n     *\n     * @param {string} message Error message\n     * @returns {Promise} Promise that resolves when modal is created\n     */\n    var showGeneralError = function(message) {\n        return showError(message, false, null);\n    };\n\n    return {\n        showError: showError,\n        showConfigError: showConfigError,\n        showGeneralError: showGeneralError\n    };\n});\n"],"names":["define","$","ModalFactory","ModalEvents","Str","Templates","showError","message","isConfigError","configUrl","modalTitle","get_strings","key","component","then","strings","configureNowStr","context","has_config_url","config_url","str_configure_now","render","html","create","type","types","DEFAULT","title","body","modal","show","setTimeout","hide","catch","error","window","alert","showConfigError","showGeneralError"],"mappings":";;;;;;;AAuBAA,mCAAO,CAAC,SAAU,qBAAsB,oBAAqB,WAAY,mBACrE,SAASC,EAAGC,aAAcC,YAAaC,IAAKC,eAWxCC,UAAY,SAASC,QAASC,cAAeC,eACzCC,WAAa,UAEVN,IAAIO,YAAY,CACnB,CAACC,IAAK,wCAAyCC,UAAW,iBAC1D,CAACD,IAAK,aAAcC,UAAW,iBAC/B,CAACD,IAAK,gBAAiBC,UAAW,mBACnCC,MAAK,SAASC,SACbL,WAAaF,cAAgBO,QAAQ,GAAKA,QAAQ,OAC9CC,gBAAkBD,QAAQ,GAG1BE,QAAU,CACVV,QAASA,QACTW,iBAAkBT,UAClBU,WAAYV,WAAa,GACzBW,kBAAmBJ,wBAIhBX,UAAUgB,OAAO,iCAAkCJ,YAC3DH,MAAK,SAASQ,aACNpB,aAAaqB,OAAO,CACvBC,KAAMtB,aAAauB,MAAMC,QACzBC,MAAOjB,WACPkB,KAAMN,UAEXR,MAAK,SAASe,cACbA,MAAMC,OAGDtB,eACDuB,YAAW,WACPF,MAAMG,SACP,KAGAH,SACRI,OAAM,SAASC,aAEdC,OAAOC,MAAM7B,SACP2B,gBAyBP,CACH5B,UAAWA,UACX+B,gBAhBkB,SAAS9B,QAASE,kBAC7BH,UAAUC,SAAS,EAAME,YAgBhC6B,iBAPmB,SAAS/B,gBACrBD,UAAUC,SAAS,EAAO"}