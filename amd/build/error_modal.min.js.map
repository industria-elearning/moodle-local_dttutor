{"version":3,"file":"error_modal.min.js","sources":["../src/error_modal.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Error modal for Tutor-IA\n *\n * @module     local_dttutor/error_modal\n * @copyright  2025 Datacurso\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/modal_factory', 'core/modal_events', 'core/str'], function($, ModalFactory, ModalEvents, Str) {\n    'use strict';\n\n    /**\n     * Show error modal with friendly message\n     *\n     * @param {string} message Error message to display\n     * @param {boolean} isConfigError Whether this is a configuration error\n     * @param {string} configUrl Optional configuration URL for admins\n     * @returns {Promise} Promise that resolves when modal is created\n     */\n    var showError = function(message, isConfigError, configUrl) {\n        return Str.get_strings([\n            {key: 'error_webservice_not_configured_short', component: 'local_dttutor'},\n            {key: 'pluginname', component: 'local_dttutor'}\n        ]).then(function(strings) {\n            var title = isConfigError ? strings[0] : strings[1];\n            var body = '<div class=\"tutor-ia-error-modal\">';\n            body += '<div class=\"alert alert-warning\">';\n            body += '<i class=\"fa fa-exclamation-triangle\"></i> ';\n            body += '<span>' + message + '</span>';\n            body += '</div>';\n\n            if (configUrl) {\n                body += '<div class=\"mt-3\">';\n                body += '<a href=\"' + configUrl + '\" class=\"btn btn-primary\" target=\"_blank\">';\n                body += '<i class=\"fa fa-cog\"></i> ';\n                body += 'Configure Now';\n                body += '</a>';\n                body += '</div>';\n            }\n\n            body += '</div>';\n\n            return ModalFactory.create({\n                type: ModalFactory.types.DEFAULT,\n                title: title,\n                body: body\n            });\n        }).then(function(modal) {\n            modal.show();\n\n            // Auto-hide after 10 seconds if not a config error\n            if (!isConfigError) {\n                setTimeout(function() {\n                    modal.hide();\n                }, 10000);\n            }\n\n            return modal;\n        }).catch(function(error) {\n            // Fallback to alert if modal creation fails\n            window.alert(message);\n            throw error;\n        });\n    };\n\n    /**\n     * Show configuration error modal\n     *\n     * @param {string} message Error message\n     * @param {string} configUrl Optional configuration URL\n     * @returns {Promise} Promise that resolves when modal is created\n     */\n    var showConfigError = function(message, configUrl) {\n        return showError(message, true, configUrl);\n    };\n\n    /**\n     * Show general error modal\n     *\n     * @param {string} message Error message\n     * @returns {Promise} Promise that resolves when modal is created\n     */\n    var showGeneralError = function(message) {\n        return showError(message, false, null);\n    };\n\n    return {\n        showError: showError,\n        showConfigError: showConfigError,\n        showGeneralError: showGeneralError\n    };\n});\n"],"names":["define","$","ModalFactory","ModalEvents","Str","showError","message","isConfigError","configUrl","get_strings","key","component","then","strings","title","body","create","type","types","DEFAULT","modal","show","setTimeout","hide","catch","error","window","alert","showConfigError","showGeneralError"],"mappings":";;;;;;;AAuBAA,mCAAO,CAAC,SAAU,qBAAsB,oBAAqB,aAAa,SAASC,EAAGC,aAAcC,YAAaC,SAWzGC,UAAY,SAASC,QAASC,cAAeC,kBACtCJ,IAAIK,YAAY,CACnB,CAACC,IAAK,wCAAyCC,UAAW,iBAC1D,CAACD,IAAK,aAAcC,UAAW,mBAChCC,MAAK,SAASC,aACTC,MAAQP,cAAgBM,QAAQ,GAAKA,QAAQ,GAC7CE,KAAO,4CACXA,MAAQ,oCACRA,MAAQ,8CACRA,MAAQ,SAAWT,QAAU,UAC7BS,MAAQ,SAEJP,YACAO,MAAQ,qBACRA,MAAQ,YAAcP,UAAY,6CAClCO,MAAQ,6BACRA,MAAQ,gBACRA,MAAQ,OACRA,MAAQ,UAGZA,MAAQ,SAEDb,aAAac,OAAO,CACvBC,KAAMf,aAAagB,MAAMC,QACzBL,MAAOA,MACPC,KAAMA,UAEXH,MAAK,SAASQ,cACbA,MAAMC,OAGDd,eACDe,YAAW,WACPF,MAAMG,SACP,KAGAH,SACRI,OAAM,SAASC,aAEdC,OAAOC,MAAMrB,SACPmB,gBAyBP,CACHpB,UAAWA,UACXuB,gBAhBkB,SAAStB,QAASE,kBAC7BH,UAAUC,SAAS,EAAME,YAgBhCqB,iBAPmB,SAASvB,gBACrBD,UAAUC,SAAS,EAAO"}