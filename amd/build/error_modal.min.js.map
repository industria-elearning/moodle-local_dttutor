{"version":3,"file":"error_modal.min.js","sources":["../src/error_modal.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Error modal for Tutor-IA\n *\n * @module     local_dttutor/error_modal\n * @copyright  2025 Datacurso\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Modal from 'core/modal';\nimport * as Str from 'core/str';\nimport * as Templates from 'core/templates';\n\n    /**\n     * Show error modal with friendly message\n     *\n     * @param {string} message Error message to display\n     * @param {boolean} isConfigError Whether this is a configuration error\n     * @param {string} configUrl Optional configuration URL for admins\n     * @returns {Promise} Promise that resolves when modal is created\n     */\n    const showError = async(message, isConfigError, configUrl) => {\n        try {\n            const strings = await Str.get_strings([\n                {key: 'error_webservice_not_configured_short', component: 'local_dttutor'},\n                {key: 'pluginname', component: 'local_dttutor'},\n                {key: 'configure_now', component: 'local_dttutor'}\n            ]);\n\n            const modalTitle = isConfigError ? strings[0] : strings[1];\n            const configureNowStr = strings[2];\n\n            // Prepare template context.\n            const context = {\n                message: message,\n                has_config_url: !!configUrl,\n                config_url: configUrl || '',\n                str_configure_now: configureNowStr\n            };\n\n            // Render template.\n            const html = await Templates.render('local_dttutor/error_modal_body', context);\n\n            // Create modal using new API.\n            const modal = await Modal.create({\n                title: modalTitle,\n                body: html,\n                show: true,\n                removeOnClose: true\n            });\n\n            // Auto-hide after 10 seconds if not a config error.\n            if (!isConfigError) {\n                setTimeout(() => {\n                    modal.hide();\n                }, 10000);\n            }\n\n            return modal;\n        } catch (error) {\n            // Fallback to alert if modal/template fails.\n            window.alert(message);\n            throw error;\n        }\n    };\n\n    /**\n     * Show configuration error modal\n     *\n     * @param {string} message Error message\n     * @param {string} configUrl Optional configuration URL\n     * @returns {Promise} Promise that resolves when modal is created\n     */\n    export const showConfigError = (message, configUrl) => {\n        return showError(message, true, configUrl);\n    };\n\n    /**\n     * Show general error modal\n     *\n     * @param {string} message Error message\n     * @returns {Promise} Promise that resolves when modal is created\n     */\n    export const showGeneralError = (message) => {\n        return showError(message, false, null);\n    };\n\n    export default {\n        showError,\n        showConfigError,\n        showGeneralError\n    };\n"],"names":["showError","async","message","isConfigError","configUrl","strings","Str","get_strings","key","component","modalTitle","context","has_config_url","config_url","str_configure_now","html","Templates","render","modal","Modal","create","title","body","show","removeOnClose","setTimeout","hide","error","window","alert","showConfigError","showGeneralError"],"mappings":";;;;;;;ysCAmCUA,UAAYC,MAAMC,QAASC,cAAeC,uBAElCC,cAAgBC,IAAIC,YAAY,CAClC,CAACC,IAAK,wCAAyCC,UAAW,iBAC1D,CAACD,IAAK,aAAcC,UAAW,iBAC/B,CAACD,IAAK,gBAAiBC,UAAW,mBAGhCC,WAAaP,cAAgBE,QAAQ,GAAKA,QAAQ,GAIlDM,QAAU,CACZT,QAASA,QACTU,iBAAkBR,UAClBS,WAAYT,WAAa,GACzBU,kBAPoBT,QAAQ,IAW1BU,WAAaC,UAAUC,OAAO,iCAAkCN,SAGhEO,YAAcC,eAAMC,OAAO,CAC7BC,MAAOX,WACPY,KAAMP,KACNQ,MAAM,EACNC,eAAe,WAIdrB,eACDsB,YAAW,KACPP,MAAMQ,SACP,KAGAR,MACT,MAAOS,aAELC,OAAOC,MAAM3B,SACPyB,QAWDG,gBAAkB,CAAC5B,QAASE,YAC9BJ,UAAUE,SAAS,EAAME,0DASvB2B,iBAAoB7B,SACtBF,UAAUE,SAAS,EAAO,8DAGtB,CACXF,UAAAA,UACA8B,gBAAAA,gBACAC,iBAAAA"}